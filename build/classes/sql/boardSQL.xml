<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/
sql-map-2.dtd'>
<sqlMap>

	<typeAlias alias="board" type="admin.board.AdminboardVO" />
	<typeAlias type="member.board.cboardVO" alias="commentt" />

	<!-- 由ъ젅??留??뺤쓽 -->
	<resultMap id="boardRes" class="board">
		<result property="board_num" column="board_num" />
		<result property="board_subject" column="board_subject" />
		<result property="board_content" column="board_content" />
		<result property="board_readhit" column="board_readhit" />
		<result property="board_regdate" column="board_regdate" />
		<result property="board_admin" column="board_admin" />
		<result property="board_orgname" column="board_orgname" />
		<result property="board_savname" column="board_savname" />
		<!-- <result property="board_commentno" column="board_commentno"/> -->
	</resultMap>

	
	<resultMap class="commentt" id="commentRes">

		<result column="comment_number" property="comment_number" />
		<result column="originno" property="originno" />
		<result column="comment_name" property="comment_name" />
		<result column="comment_password" property="comment_password" />
		<result column="comment_content" property="comment_content" />
		<result column="comment_date" property="comment_date" />
	</resultMap>




	<!-- 怨듯넻?쇰줈 ?ъ슜??select ???뺤쓽 -->
	<sql id="select-all">
		select*from board
	</sql>

<sql id="select-com">
select * from commentt
</sql>
	<!-- 怨듯넻?쇰줈 ?ъ슜??where-no ???뺤쓽 -->
	<sql id="where-no">
		WHERE board_num = #board_num#
	</sql>

	<!-- select 荑쇰━臾??뺤쓽 -->
	<select id="selectAll" resultMap="boardRes">
		<include refid="select-all" />
		order by board_num desc
	</select>

	<select id="selectOne" resultMap="boardRes" parameterClass="int">
		<include refid="select-all" />
		<include refid="where-no" />
	</select>
	
<select id="commentSelectAll" resultMap="commentRes" parameterClass="int">
		SELECT * FROM commentt
		 WHERE originno = #board_num#
		 ORDER BY comment_number DESC
	</select>

	<!-- 寃 ??濡쒖쭅 異붽? -->
	<select id="selectSearchW" parameterClass="string" resultMap="boardRes">
		<include refid="select-all" />
		where board_admin like #searchKeyword# order by board_num desc
	</select>

	<select id="selectSearchS" parameterClass="string" resultMap="boardRes">
		<include refid="select-all" />
		where board_subject like #searchKeyword# order by board_num desc
	</select>

	<select id="selectSearchC" parameterClass="string" resultMap="boardRes">
		<include refid="select-all" />
		where board_content like #searchKeyword# order by board_num desc
	</select>

	<select id="selectLastNo" resultClass="board">
		SELECT max(board_num) as
		board_num from board
	</select>


<select id="selectPassword" resultMap="commentRes">

		<include refid="select-com" />

		<include refid="where-no" />
		AND comment_password = #comment_password#
</select>
		<!-- insert 荑쇰━臾??뺤쓽 -->
		<insert id="insertBoard" parameterClass="board">

			insert into board
			(board_num,board_subject,board_admin,board_content,board_regdate)
			values
			(board_no_seq.nextval,#board_subject#,#board_admin#,#board_content#,#board_regdate#)
		</insert>

		<insert id="insertComment" parameterClass="commentt">
			insert into commentt
			(comment_number,comment_name,comment_password,comment_content,comment_date,originno)
			values(commentt_no_seq.nextval,#comment_name#,#comment_password#,#comment_content#,#comment_date#,#originno#)
		</insert>


		<!-- update 荑쇰━臾??뺤쓽 -->
		<update id="updateBoard" parameterClass="board">
			update board set board_subject = #board_subject#,
			board_admin = #board_admin#,
			board_content=#board_content#
			<include refid="where-no" />
		</update>

		<update id="updateFile" parameterClass="board">
			update board set board_orgname = #board_orgname# , board_savname =
			#board_savname#
			<include refid="where-no" />
		</update>

		<update id="updateReadHit" parameterClass="board">
			update board set board_readhit = board_readHit + 1
			<include refid="where-no" />
		</update>


		<!-- delete 荑쇰━臾??뺤쓽 -->
		<delete id="deleteBoard" parameterClass="board">
			delete from board
			<include refid="where-no" />
		</delete>

</sqlMap>
